# !!! FILE MANAGED BY SALT !!!
#
# Shorewall version 4.0 - Sample Rules File for one-interface configuration.
# Copyright (C) 2006 by the Shorewall Team
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 2.1 of the License, or (at your option) any later version.
#
# See the file README.txt for further details.
#------------------------------------------------------------------------------------------------------------
# For information on entries in this file, type "man shorewall-rules"
######################################################################################################################################################################################
#ACTION         SOURCE          DEST            PROTO   DEST    SOURCE          ORIGINAL        RATE            USER/   MARK    CONNLIMIT       TIME         HEADERS         SWITCH
#                                                       PORT    PORT(S)         DEST            LIMIT           GROUP
#SECTION ALL
#SECTION ESTABLISHED
#SECTION RELATED
SECTION NEW
{%- for rules in salt['pillar.get']('shorewall:rules', {}) %}

# {{ rules.get('comment', '') }}
{{ rules.get('action') }}  {{ rules.get('source') }}  {{ rules.get('dest') }}  {{ rules.get('proto', '-') }}  {{ rules.get('destport', '-') }}  {{ rules.get('sourceport', '-') }}  {{ rules.get('originaldest', '-') }}  {{ rules.get('ratelimit', '-') }}  {{ rules.get('usergroup', '-') }}  {{ rules.get('mark', '-') }}  {{ rules.get('connlimit', '-') }}  {{ rules.get('time', '-') }}  {{ rules.get('headers', '-') }}  {{ rules.get('switch', '') }}
{%- endfor %}
